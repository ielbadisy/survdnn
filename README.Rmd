---
output: github_document
---

# survdnn <img src="https://raw.githubusercontent.com/ielbadisy/survdnn/main/inst/logo.png" align="right" height="140"/>

> Deep Neural Networks for Survival Analysis Using [torch](https://torch.mlverse.org/)

[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![R-CMD-check](https://github.com/ielbadisy/survdnn/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/ielbadisy/survdnn/actions)

`survdnn` implements flexible deep learning models for right-censored survival data using the powerful `torch` backend in R. It supports Cox, AFT, and ranking-based objectives, provides a formula interface, and includes model evaluation, cross-validation, hyperparameter tuning, and interpretability utilities.

---

## Features

- Formula interface for `Surv()` models

- Modular neural architectures with user-defined depth, activation, and loss

- Built-in support for:
  - Cox partial likelihood loss
  - Accelerated Failure Time (AFT) loss
  - Ranking loss
  - Custom user-defined losses

- Model evaluation: C-index, Brier score, and IBS.

- Cross-validation and hyperparameter tuning with `cv_survdnn()` and `tune_survdnn()`

- Predict survival curves and visualize using `plot()`

- Torch-native, GPU compatible (comming soon)

---

## Installation

```{r, eval = FALSE}
# Install from GitHub
remotes::install_github("ielbadisy/survdnn")

# Or clone + install locally
# git clone https://github.com/ielbadisy/survdnn.git
# setwd("survdnn")
# devtools::install()
```



---

## Quick Example

```{r}
library(survdnn)
library(survival)

data(veteran, package = "survival")

mod <- survdnn(Surv(time, status) ~ age + karno + celltype,
               data = veteran,
               hidden = c(32, 16),
               epochs = 100,
               verbose = TRUE)

summary(mod)
plot(mod, group_by = "celltype", times = 1:300)
```

---

## Loss Functions

```{r}
# Default: Cox partial likelihood
mod1 <- survdnn(Surv(time, status) ~ age + karno,
                data = veteran,
                .loss_fn = cox_loss,
                epochs = 100)

# AFT loss
mod2 <- survdnn(Surv(time, status) ~ age + karno,
                data = veteran,
                .loss_fn = aft_loss,
                epochs = 100)
```

---

## Cross-Validation

```{r}
cv_results <- cv_survdnn(
  Surv(time, status) ~ age + karno + celltype,
  data = veteran,
  times = c(30, 90, 180),
  metrics = c("cindex", "ibs"),
  folds = 3,
  hidden = c(16, 8),
  epochs = 100
  )
print(cv_results)
```

---

## Hyperparameter Tuning

```{r}
grid <- list(
  hidden     = list(c(16), c(32, 16)),
  lr         = c(1e-3),
  activation = c("relu"),
  epochs     = c(100),
  .loss_fn   = list(cox_loss, aft_loss),
  loss_name  = c("cox_loss", "aft_loss")
  )

tune_res <- tune_survdnn(
  formula = Surv(time, status) ~ age + karno + celltype,
  data = veteran,
  times = c(90, 300),
  metrics = c("cindex"),
  param_grid = grid,
  folds = 3,
  return = "summary"
  )
print(tune_res)
```

---

## Plot Survival Curves

```{r}
plot(mod1, group_by = "celltype", times = 1:300)  # individual + mean curves
plot(mod1, group_by = "celltype", times = 1:300, plot_mean_only = TRUE)  # mean only
```

---

## Documentation

Full documentation with examples, loss definitions, metric evaluators, and model structure is available via:

```{r}
help(package = "survdnn")
?survdnn
?cox_loss
?tune_survdnn
?plot.survdnn
```

---

## Testing

Run all unit tests (TODO):

```{r, eval = FALSE}
devtools::test()
```

---

## Contributions

Contributions, issues, and feature requests are welcome. See the [Issues page](https://github.com/ielbadisy/survdnn/issues).

---

##  License

MIT Â© [Imad El Badisy](mailto:elbadisyimad@gmail.com)


